<div class="max-w-2xl mx-auto mt-12 p-6">
  <div *ngIf="profile" class="bg-gray-50 rounded-lg p-8 shadow-md">
    <h2 class="text-2xl font-bold text-gray-800 mb-4">¬°Bienvenido, {{profile.display_name}}!</h2>
    
    <img 
      *ngIf="profile.images?.length" 
      [src]="profile.images[0].url" 
      alt="Profile" 
      class="w-36 h-36 rounded-full mx-auto mb-4 shadow-lg" />
    
    <div class="space-y-2 text-gray-700">
      <p><span class="font-semibold">Email:</span> {{profile.email}}</p>
      <p><span class="font-semibold">Pa√≠s:</span> {{profile.country}}</p>
      <p><span class="font-semibold">Seguidores:</span> {{profile.followers?.total}}</p>
    </div>
    
        <!-- Flecha derecha (muestra con canScrollLatestRight()) -->
    <button 
          *ngIf="canScrollLatestRight()"
          (click)="scrollLatestRight()"
          aria-label="Desplazar √∫ltimas rese√±as a la derecha"
          style="
            position:absolute; right:6px; top:50%;
            transform:translateY(-50%);
            z-index:40;
            width:36px; height:36px; border-radius:999px;
            background:white; border:1px solid rgba(15,23,42,0.06);
            box-shadow: 0 6px 18px rgba(2,6,23,0.06);
            display:flex; align-items:center; justify-content:center; cursor:pointer;
          "
        >
          <!-- √çcono SVG -->
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#0f172a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 5l7 7-7 7"/></svg>
    </button>
  </div>

    <!-- TABS -->
    <nav style="display:flex; justify-content:center; padding:20px 0;">
      <div style="display:flex; gap:16px; align-items:center;">
        <button (click)="setActiveTab('diario')" [attr.aria-pressed]="activeTab === 'diario'" [style.background]="activeTab === 'diario' ? 'linear-gradient(90deg,#1db954,#7c3aed)' : '#F8FAFC'" [style.color]="activeTab === 'diario' ? '#fff' : '#071431'" style="padding:12px 28px; border-radius:999px; border:1px solid rgba(15,23,42,0.04); font-weight:600; font-size:1.1rem; cursor:pointer; transition: all 180ms ease;">Diario</button>

        <button (click)="setActiveTab('likes')" [attr.aria-pressed]="activeTab === 'likes'" [style.background]="activeTab === 'likes' ? 'linear-gradient(90deg,#1db954,#7c3aed)' : '#F8FAFC'" [style.color]="activeTab === 'likes' ? '#fff' : '#071431'" style="padding:12px 28px; border-radius:999px; border:1px solid rgba(15,23,42,0.04); font-weight:600; font-size:1.1rem; cursor:pointer; transition: all 180ms ease;">Me gusta</button>
      </div>
    </nav>

    <!-- GALLERY CIRCULAR - G3: Auto + Arrastre + Velocidad Din√°mica -->
    <section style="position:relative; padding:12px 0 0 0; overflow:hidden; width:100%; height:calc(100vh - 500px); min-height:500px; max-height:700px;">
      <!-- Left control - posicionado en el borde izquierdo de la pantalla -->
      <button (click)="rotateCircleLeft()" aria-label="Rotar izquierda" style="position:absolute; left:20px; top:50%; transform:translateY(-50%); z-index:60; width:48px; height:48px; border-radius:999px; background:white; border:1px solid rgba(15,23,42,0.06); box-shadow:0 8px 28px rgba(2,6,23,0.06); display:flex; align-items:center; justify-content:center; cursor:pointer;">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#0f172a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 19l-7-7 7-7"/></svg>
      </button>

      <!-- Right control - posicionado en el borde derecho de la pantalla -->
      <button (click)="rotateCircleRight()" aria-label="Rotar derecha" style="position:absolute; right:20px; top:50%; transform:translateY(-50%); z-index:60; width:48px; height:48px; border-radius:999px; background:white; border:1px solid rgba(15,23,42,0.06); box-shadow:0 8px 28px rgba(2,6,23,0.06); display:flex; align-items:center; justify-content:center; cursor:pointer;">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#0f172a" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 5l7 7-7 7"/></svg>
      </button>

      <div style="position:relative; width:100%; height:100%; display:flex; justify-content:center; align-items:flex-start; overflow:hidden; padding:0 20px;">
        <!-- Contenedor circular (es muy grande internamente): aqu√≠ es donde aplicamos pointer events para arrastrar -->
        <div
          #galleryContainer
          (pointerdown)="onCirclePointerDown($event)"
          (pointermove)="onCirclePointerMove($event)"
          (pointerup)="onCirclePointerUp($event)"
          (pointercancel)="onCirclePointerUp($event)"
          (pointerleave)="onCirclePointerUp($event)"
          style="position:relative; width:100%; height:100%; display:block; overflow:visible; touch-action:pan-y; -ms-touch-action:pan-y;"
        >
          <!-- "canvas" circular: tama√±o responsivo calculado desde TS -->
          <div
            [style.width.px]="getCircleContainerWidth()"
            [style.height.px]="getCircleContainerWidth()"
            style="position:absolute; left:50%; top:0; transform:translateX(-50%); border-radius:50%; overflow:visible; pointer-events:none; clip-path:polygon(0% 0%, 100% 0%, 100% 50%, 0% 50%);"
          >
            <!-- Tarjetas posicionadas absolutamente dentro del gran contenedor circular -->
            @if (displayedCircleReviews.length) {
              @for (review of displayedCircleReviews; track review.spotify_id + '_' + $index; let i = $index) {
                @let circleReview = getCircleReview(i);
                <div
                  role="button"
                  (click)="openReview(circleReview)"
                  class="circle-card"
                  [style.transform]="getCircleCardTransform(i)"
                  [style.z-index]="getCircleCardZIndex(i)"
                  (mouseenter)="onCircleCardMouseEnter($event, i)"
                  (mouseleave)="onCircleCardMouseLeave($event, i)"
                      style="position:absolute; width:160px; height:160px; border-radius:16px; overflow:hidden; box-shadow: 0 18px 48px rgba(2,6,23,0.14); transition: transform 380ms cubic-bezier(.2,.9,.3,1), filter 380ms ease; background:#f8fafc; cursor:pointer; pointer-events:auto;"
                >
                  @if (circleReview?.album_image || circleReview?.image_url) {
                    <img [src]="circleReview.album_image || circleReview.image_url" [alt]="circleReview.title || circleReview.spotify_id" style="width:100%; height:100%; object-fit:cover; display:block;" />
                  } @else {
                    <div style="width:100%; height:100%; display:flex; align-items:center; justify-content:center; background:linear-gradient(135deg,#1db954,#7c3aed); color:white; font-weight:800; font-size:14px;">
                      {{ (circleReview?.spotify_id || 'R').substring(0,2) }}
                    </div>
                  }
                </div>
              }
            } @else {
              <!-- Placeholders en c√≠rculo -->
              <div style="position:absolute; width:140px; height:140px; border-radius:12px; background:#f8fafc; box-shadow: 0 12px 30px rgba(2,6,23,0.08); transform: translate(0, -230px) rotate(0deg);"></div>
            }
          </div>
        </div>
      </div>
    </section>

    <!-- ERROR / TOAST -->
    @if (error) {
      <div style="position:fixed; top:16px; left:16px; right:16px; max-width:420px; margin:0 auto; background:#fff5f5; border:1px solid #fecaca; color:#991b1b; padding:10px 14px; border-radius:8px; z-index:60;">
        <p style="margin:0; font-size:0.9rem;">Error: {{ error }}</p>
      </div>
    }

    <!-- BOTTOM NAV -->
    <footer style="position:fixed; left:0; right:0; bottom:0; background:white; border-top:1px solid rgba(15,23,42,0.04); display:flex; justify-content:center; padding:12px 0; z-index:80;">
      <div style="width:100%; max-width:1200px; display:flex; justify-content:space-around; align-items:center;">
        <a [routerLink]="['/app/feed']" routerLinkActive="active" [routerLinkActiveOptions]="{exact: false}" style="text-decoration:none; color:#0f172a; font-size:24px; padding:8px;">üè†</a>
        <a [routerLink]="['/app/search']" routerLinkActive="active" [routerLinkActiveOptions]="{exact: false}" style="text-decoration:none; color:#0f172a; font-size:24px; padding:8px;">üîé</a>
        <a [routerLink]="['/review']" routerLinkActive="active" [routerLinkActiveOptions]="{exact: false}" style="text-decoration:none;">
          <div style="width:64px; height:64px; border-radius:16px; display:flex; align-items:center; justify-content:center; background:linear-gradient(90deg,#1db954,#7c3aed); font-size:32px; color:white; transform:translateY(-8px); box-shadow: 0 14px 32px rgba(29,185,84,0.12);">+</div>
        </a>
        <a [routerLink]="['/app/bookmarks']" routerLinkActive="active" [routerLinkActiveOptions]="{exact: false}" style="text-decoration:none; color:#0f172a; font-size:24px; padding:8px;">üîñ</a>
        <a [routerLink]="['/app/profile']" routerLinkActive="active" [routerLinkActiveOptions]="{exact: false}" style="text-decoration:none; color:#0f172a; font-size:24px; padding:8px;">üë§</a>
      </div>
    </footer>
  </div>
